"""
–°–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Å–∏—Å—Ç–µ–º—É NLP –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
"""

try:
    from natasha import (
        Segmenter, MorphVocab, NewsEmbedding,
        NewsMorphTagger, NewsSyntaxParser, NewsNERTagger,
        NamesExtractor, Doc
    )

    NATASHA_AVAILABLE = True
except ImportError:
    NATASHA_AVAILABLE = False
    print("‚ö†Ô∏è Natasha –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è rule-based –ø–æ–¥—Ö–æ–¥")

from datetime import datetime


class NLPService:
    """
    –°–µ—Ä–≤–∏—Å NLPService –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è (intent), –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã.
    """

    # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Ç–æ–≤
    INTENT_KEYWORDS = {
        '–¥–æ–≥–æ–≤–æ—Ä_–∞—Ä–µ–Ω–¥—ã': ['–∞—Ä–µ–Ω–¥', '—Å–Ω—è—Ç—å', '–∞—Ä–µ–Ω–¥–æ–≤–∞', '–Ω–∞–π–º', '—Å–¥–∞—á'],
        '–¥–æ–≥–æ–≤–æ—Ä_–∫—É–ø–ª–∏_–ø—Ä–æ–¥–∞–∂–∏': ['–∫—É–ø–ª', '–ø—Ä–æ–¥–∞–∂', '–ø—Ä–∏–æ–±—Ä–µ—Ç', '–ø–æ–∫—É–ø', '—Å–¥–µ–ª–∫'],
        '—Ç—Ä—É–¥–æ–≤–æ–π_–¥–æ–≥–æ–≤–æ—Ä': ['—Ç—Ä—É–¥–æ–≤', '—Ä–∞–±–æ—Ç', '—É—Å—Ç—Ä–æ', '–ø—Ä–∏–µ–º', '—É–≤–æ–ª—å–Ω'],
        '–±—Ä–∞—á–Ω—ã–π_–¥–æ–≥–æ–≤–æ—Ä': ['–±—Ä–∞—á–Ω', '—Å—É–ø—Ä—É–≥', '–±—Ä–∞–∫', '—Å–µ–º–µ–π–Ω'],
        '–∞–ª–∏–º–µ–Ω—Ç—ã': ['–∞–ª–∏–º–µ–Ω—Ç', '—Å–æ–¥–µ—Ä–∂–∞–Ω', '—Ä–µ–±–µ–Ω–æ–∫', '–¥–µ—Ç'],
        '—Ä–∞–∑–≤–æ–¥': ['—Ä–∞–∑–≤–æ–¥', '—Ä–∞–∑–≤–µ—Å—Ç', '—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω'],
        '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ': ['–Ω–∞—Å–ª–µ–¥—Å—Ç–≤', '–∑–∞–≤–µ—â–∞–Ω', '–Ω–∞—Å–ª–µ–¥–Ω–∏–∫'],
        '–Ω–∞–ª–æ–≥': ['–Ω–∞–ª–æ–≥', '–Ω–∞–ª–æ–≥–æ–≤', '–≤—ã—á–µ—Ç', '–¥–µ–∫–ª–∞—Ä–∞—Ü'],
        '–∂–∞–ª–æ–±–∞': ['–∂–∞–ª–æ–±', '–ø—Ä–µ—Ç–µ–Ω–∑', '–Ω–µ–¥–æ–≤–æ–ª'],
        '–∏—Å–∫–æ–≤–æ–µ_–∑–∞—è–≤–ª–µ–Ω–∏–µ': ['–∏—Å–∫–æ–≤', '—Å—É–¥', '–∏—Å–∫', '–∑–∞—è–≤–ª–µ–Ω'],
        '–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å': ['–¥–æ–≤–µ—Ä–µ–Ω', '–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤'],
        '—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ_–¥–æ–≥–æ–≤–æ—Ä–∞': ['—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω', '–ø—Ä–µ–∫—Ä–∞—â–µ–Ω', '–∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω'],
    }

    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è NLP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"""
        if NATASHA_AVAILABLE:
            self.segmenter = Segmenter()
            self.morph_vocab = MorphVocab()
            self.emb = NewsEmbedding()
            self.morph_tagger = NewsMorphTagger(self.emb)
            self.syntax_parser = NewsSyntaxParser(self.emb)
            self.ner_tagger = NewsNERTagger(self.emb)
            self.names_extractor = NamesExtractor(self.morph_vocab)
            print("‚úÖ NLP –º–æ–¥–µ–ª—å Natasha –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
        else:
            self.segmenter = None

    def process_query(self, text):
        """
        –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

        Args:
            text (str): –¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞

        Returns:
            dict: –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ —Å –∏–Ω—Ç–µ–Ω—Ç–æ–º, –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π, –æ—Ç–≤–µ—Ç–æ–º
        """
        print(f"üîç –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞: '{text}'")

        text_lower = text.lower().strip()

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω—Ç–µ–Ω—Ç
        intent = '–æ–±—â–∏–π_–≤–æ–ø—Ä–æ—Å'
        confidence = 0.3

        if NATASHA_AVAILABLE and self.segmenter:
            intent, confidence = self._analyze_with_natasha(text_lower)
        else:
            intent, confidence = self._analyze_rule_based(text_lower)

        print(f"   –û–ø—Ä–µ–¥–µ–ª–µ–Ω –∏–Ω—Ç–µ–Ω—Ç: {intent} (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence:.2f})")

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        category = self._detect_category(intent, text_lower)
        print(f"   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {category}")

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
        response = self._generate_response(intent, category, text_lower)

        return {
            'intent': intent,
            'category': category,
            'confidence': confidence,
            'response': response,
            'timestamp': datetime.now().strftime('%H:%M'),
            'icon': self._get_icon(intent)
        }

    def _analyze_with_natasha(self, text):
        """–ê–Ω–∞–ª–∏–∑ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Natasha"""
        try:
            doc = Doc(text)
            doc.segment(self.segmenter)
            doc.tag_morph(self.morph_tagger)

            lemmas = []
            for token in doc.tokens:
                token.lemmatize(self.morph_vocab)
                lemmas.append(token.lemma)

            lemmatized_text = ' '.join(lemmas).lower()

            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –ª–µ–º–º–∞–º
            intent_scores = {}
            for intent_name, keywords in self.INTENT_KEYWORDS.items():
                score = sum(2 if kw in lemmatized_text else 0 for kw in keywords)
                score += sum(1 if kw in text else 0 for kw in keywords)
                if score > 0:
                    intent_scores[intent_name] = score

            if intent_scores:
                best_intent = max(intent_scores.items(), key=lambda x: x[1])
                return best_intent[0], min(best_intent[1] / 10, 0.95)

            return '–æ–±—â–∏–π_–≤–æ–ø—Ä–æ—Å', 0.3
        except Exception as e:
            print(f"   –û—à–∏–±–∫–∞ Natasha: {e}")
            return self._analyze_rule_based(text)

    def _analyze_rule_based(self, text):
        """–ü—Ä–æ—Å—Ç–æ–π rule-based –∞–Ω–∞–ª–∏–∑"""
        intent_scores = {}

        for intent_name, keywords in self.INTENT_KEYWORDS.items():
            score = sum(1 for kw in keywords if kw in text)
            if score > 0:
                intent_scores[intent_name] = score

        if intent_scores:
            best_intent = max(intent_scores.items(), key=lambda x: x[1])
            return best_intent[0], min(best_intent[1] / 5, 0.8)

        return '–æ–±—â–∏–π_–≤–æ–ø—Ä–æ—Å', 0.3

    def _detect_category(self, intent, text):
        """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–ø—Ä–æ—Å–∞"""
        categories = {
            '–≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ_–ø—Ä–∞–≤–æ': ['–¥–æ–≥–æ–≤–æ—Ä_–∞—Ä–µ–Ω–¥—ã', '–¥–æ–≥–æ–≤–æ—Ä_–∫—É–ø–ª–∏_–ø—Ä–æ–¥–∞–∂–∏',
                                  '–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å', '—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ_–¥–æ–≥–æ–≤–æ—Ä–∞'],
            '—Ç—Ä—É–¥–æ–≤–æ–µ_–ø—Ä–∞–≤–æ': ['—Ç—Ä—É–¥–æ–≤–æ–π_–¥–æ–≥–æ–≤–æ—Ä'],
            '—Å–µ–º–µ–π–Ω–æ–µ_–ø—Ä–∞–≤–æ': ['–±—Ä–∞—á–Ω—ã–π_–¥–æ–≥–æ–≤–æ—Ä', '–∞–ª–∏–º–µ–Ω—Ç—ã', '—Ä–∞–∑–≤–æ–¥'],
            '–Ω–∞–ª–æ–≥–æ–≤–æ–µ_–ø—Ä–∞–≤–æ': ['–Ω–∞–ª–æ–≥'],
            '—Å—É–¥–µ–±–Ω–æ–µ_–ø—Ä–∞–≤–æ': ['–∂–∞–ª–æ–±–∞', '–∏—Å–∫–æ–≤–æ–µ_–∑–∞—è–≤–ª–µ–Ω–∏–µ'],
        }

        for category, intents in categories.items():
            if intent in intents:
                return category

        if '–∫–≤–∞—Ä—Ç–∏—Ä' in text or '–¥–æ–º' in text:
            return '–∂–∏–ª–∏—â–Ω–æ–µ_–ø—Ä–∞–≤–æ'
        elif '–∞–≤—Ç–æ–º–æ–±–∏–ª—å' in text or '–º–∞—à–∏–Ω–∞' in text:
            return '–∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–µ_–ø—Ä–∞–≤–æ'
        elif '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤' in text:
            return '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ_–ø—Ä–∞–≤–æ'

        return '–æ–±—â–µ–µ_–ø—Ä–∞–≤–æ'

    def _generate_response(self, intent, category, text):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ–Ω—Ç–∞"""
        # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        responses = {
            '–¥–æ–≥–æ–≤–æ—Ä_–∞—Ä–µ–Ω–¥—ã': self._response_rental(),
            '–¥–æ–≥–æ–≤–æ—Ä_–∫—É–ø–ª–∏_–ø—Ä–æ–¥–∞–∂–∏': self._response_sale(),
            '—Ç—Ä—É–¥–æ–≤–æ–π_–¥–æ–≥–æ–≤–æ—Ä': self._response_labor(),
            '–±—Ä–∞—á–Ω—ã–π_–¥–æ–≥–æ–≤–æ—Ä': self._response_marriage(),
            '–∞–ª–∏–º–µ–Ω—Ç—ã': self._response_alimony(),
            '—Ä–∞–∑–≤–æ–¥': self._response_divorce(),
            '–Ω–∞–ª–æ–≥': self._response_tax(),
            '–∂–∞–ª–æ–±–∞': self._response_complaint(),
            '—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ_–¥–æ–≥–æ–≤–æ—Ä–∞': self._response_termination(),
            '–∏—Å–∫–æ–≤–æ–µ_–∑–∞—è–≤–ª–µ–Ω–∏–µ': self._response_lawsuit(),
            '–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å': self._response_power_of_attorney(),
            '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ': self._response_inheritance(),
        }

        return responses.get(intent, self._response_general(text))

    def _response_rental(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –¥–æ–≥–æ–≤–æ—Ä –∞—Ä–µ–Ω–¥—ã"""
        return """üè† **–î–æ–≥–æ–≤–æ—Ä –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä—ã**

–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –∞—Ä–µ–Ω–¥—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

üìå **–û–±—ä–µ–∫—Ç –∞—Ä–µ–Ω–¥—ã:** –∫–≤–∞—Ä—Ç–∏—Ä–∞
üìÖ **–°—Ä–æ–∫:** —É–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∞—Ä–µ–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 –≥–æ–¥)
üí∞ **–ê—Ä–µ–Ω–¥–Ω–∞—è –ø–ª–∞—Ç–∞:** —É–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É –∏ –ø–æ—Ä—è–¥–æ–∫ –æ–ø–ª–∞—Ç—ã
üè¶ **–ó–∞–ª–æ–≥:** –æ–±—ã—á–Ω–æ —Ä–∞–≤–µ–Ω 1-2 –º–µ—Å—è—á–Ω—ã–º –ø–ª–∞—Ç–µ–∂–∞–º
üè¢ **–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:** –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç

üìã **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
1. –ü–∞—Å–ø–æ—Ä—Ç–∞ —Å—Ç–æ—Ä–æ–Ω
2. –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
3. –í—ã–ø–∏—Å–∫–∞ –∏–∑ –ï–ì–†–ù
4. –°–ø—Ä–∞–≤–∫–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –ñ–ö–•

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –ì–ª–∞–≤–∞ 34 –ì–ö –†–§ (–ê—Ä–µ–Ω–¥–∞)*

üìÑ *–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —é—Ä–∏—Å—Ç—É*"""

    def _response_sale(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –¥–æ–≥–æ–≤–æ—Ä –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏"""
        return """üí∞ **–î–æ–≥–æ–≤–æ—Ä –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã**

–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

üìã **–î–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–æ–¥–∞–≤—Ü–∞:**
1. –ü–∞—Å–ø–æ—Ä—Ç
2. –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏/–≤—ã–ø–∏—Å–∫–∞ –∏–∑ –ï–ì–†–ù
3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç –ë–¢–ò
4. –°–ø—Ä–∞–≤–∫–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ–ª–≥–æ–≤ –ø–æ –ñ–ö–•
5. –ù–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å—É–ø—Ä—É–≥–∞ (–µ—Å–ª–∏ –∏–º—É—â–µ—Å—Ç–≤–æ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ)

‚öñÔ∏è **–°—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞:**
1. –ü—Ä–µ–¥–º–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞ (–∞–¥—Ä–µ—Å, –ø–ª–æ—â–∞–¥—å, –∫–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä)
2. –¶–µ–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã
3. –ü–æ—Ä—è–¥–æ–∫ —Ä–∞—Å—á–µ—Ç–æ–≤
4. –°—Ä–æ–∫ –ø–µ—Ä–µ–¥–∞—á–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã
5. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Å—Ç–æ—Ä–æ–Ω

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –ì–ª–∞–≤–∞ 30 –ì–ö –†–§ (–ö—É–ø–ª—è-–ø—Ä–æ–¥–∞–∂–∞)*

üìÑ *–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —é—Ä–∏—Å—Ç—É*"""

    def _response_labor(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ —Ç—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä"""
        return """üë®‚Äçüíº **–¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä**

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:
1. –ú–µ—Å—Ç–æ —Ä–∞–±–æ—Ç—ã
2. –¢—Ä—É–¥–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–¥–æ–ª–∂–Ω–æ—Å—Ç—å)
3. –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
4. –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞
5. –†–µ–∂–∏–º —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –æ—Ç–¥—ã—Ö–∞

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –¢—Ä—É–¥–æ–≤–æ–π –∫–æ–¥–µ–∫—Å –†–§, –ì–ª–∞–≤–∞ 10-11*"""

    def _response_marriage(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –±—Ä–∞—á–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä"""
        return """üíç **–ë—Ä–∞—á–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä**

–ë—Ä–∞—á–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—É–ø—Ä—É–≥–æ–≤.

–ú–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:
1. –†–µ–∂–∏–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (—Å–æ–≤–º–µ—Å—Ç–Ω–∞—è, –¥–æ–ª–µ–≤–∞—è, —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è)
2. –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–∑–¥–µ–ª–∞ –∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∏ —Ä–∞–∑–≤–æ–¥–µ
3. –ü—Ä–∞–≤–∞ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –ø–æ –≤–∑–∞–∏–º–Ω–æ–º—É —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –°–µ–º–µ–π–Ω—ã–π –∫–æ–¥–µ–∫—Å –†–§, –ì–ª–∞–≤–∞ 8*"""

    def _response_alimony(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –∞–ª–∏–º–µ–Ω—Ç—ã"""
        return """üë∂ **–ê–ª–∏–º–µ–Ω—Ç—ã –Ω–∞ —Ä–µ–±–µ–Ω–∫–∞**

üí∞ **–†–∞–∑–º–µ—Ä –∞–ª–∏–º–µ–Ω—Ç–æ–≤:**
1. –ù–∞ –æ–¥–Ω–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ - 1/4 –¥–æ—Ö–æ–¥–∞
2. –ù–∞ –¥–≤—É—Ö –¥–µ—Ç–µ–π - 1/3 –¥–æ—Ö–æ–¥–∞
3. –ù–∞ —Ç—Ä–µ—Ö –∏ –±–æ–ª–µ–µ –¥–µ—Ç–µ–π - 1/2 –¥–æ—Ö–æ–¥–∞

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –°–µ–º–µ–π–Ω—ã–π –∫–æ–¥–µ–∫—Å –†–§, –ì–ª–∞–≤–∞ 13, 16, 17*"""

    def _response_divorce(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ —Ä–∞–∑–≤–æ–¥"""
        return """üíî **–†–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ –±—Ä–∞–∫–∞ (—Ä–∞–∑–≤–æ–¥)**

–†–∞–∑–≤–æ–¥ –≤–æ–∑–º–æ–∂–µ–Ω:
1. –ß–µ—Ä–µ–∑ –ó–ê–ì–° - –ø–æ –≤–∑–∞–∏–º–Ω–æ–º—É —Å–æ–≥–ª–∞—Å–∏—é, –±–µ–∑ –¥–µ—Ç–µ–π –∏ —Å–ø–æ—Ä–æ–≤
2. –ß–µ—Ä–µ–∑ —Å—É–¥ - –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–µ—Ç–µ–π –∏–ª–∏ —Å–ø–æ—Ä–æ–≤

üìö *–û—Å–Ω–æ–≤–∞–Ω–∏–µ: –°–µ–º–µ–π–Ω—ã–π –∫–æ–¥–µ–∫—Å –†–§*"""

    def _response_tax(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –Ω–∞–ª–æ–≥–∏"""
        return """üìä **–ù–∞–ª–æ–≥–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã**

–ü–æ–º–æ—â—å —Å:
1. –ù–∞–ª–æ–≥–æ–≤—ã–º–∏ –≤—ã—á–µ—Ç–∞–º–∏
2. –î–µ–∫–ª–∞—Ä–∞—Ü–∏–µ–π 3-–ù–î–§–õ
3. –ù–∞–ª–æ–≥–∞–º–∏ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –∏–º—É—â–µ—Å—Ç–≤–∞

–£—Ç–æ—á–Ω–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å?"""

    def _response_complaint(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –∂–∞–ª–æ–±—É"""
        return """üìù **–ñ–∞–ª–æ–±–∞/–ø—Ä–µ—Ç–µ–Ω–∑–∏—è**

–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∂–∞–ª–æ–±—ã —É–∫–∞–∂–∏—Ç–µ:
1. –ö–æ–º—É –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
2. –°—É—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è
3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
4. –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

üìÑ *–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∂–∞–ª–æ–±—ã –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —é—Ä–∏—Å—Ç—É*"""

    def _response_termination(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞"""
        return """üìÑ **–†–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞**

–î–ª—è —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏—è:
1. –ù–∞–ø—Ä–∞–≤—å—Ç–µ –ø–∏—Å—å–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
2. –£–∫–∞–∂–∏—Ç–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è
3. –°–æ–±–ª—é–¥–∞–π—Ç–µ —Å—Ä–æ–∫–∏
4. –ü–æ–¥–ø–∏—à–∏—Ç–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ

üìö *–°—Ç–∞—Ç—å—è 450 –ì–ö –†–§*"""

    def _response_lawsuit(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –∏—Å–∫–æ–≤–æ–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ"""
        return """‚öñÔ∏è **–ò—Å–∫–æ–≤–æ–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ**

–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏—Å–∫–∞:
1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –æ—Ç–≤–µ—Ç—á–∏–∫–∞
2. –£–∫–∞–∂–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
3. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
4. –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—É

üìÑ *–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏—Å–∫–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —é—Ä–∏—Å—Ç—É*"""

    def _response_power_of_attorney(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å"""
        return """üìÉ **–î–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å**

–£–∫–∞–∂–∏—Ç–µ:
1. –ö–æ–º—É –≤—ã–¥–∞–µ—Ç—Å—è
2. –ö–∞–∫–∏–µ –ø–æ–ª–Ω–æ–º–æ—á–∏—è
3. –ù–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫
4. –ù–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

üìÑ *–î–ª—è —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —é—Ä–∏—Å—Ç—É*"""

    def _response_inheritance(self):
        """–û—Ç–≤–µ—Ç –ø—Ä–æ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ"""
        return """üìú **–ù–∞—Å–ª–µ–¥—Å—Ç–≤–æ**

–î–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–∞:
1. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –Ω–æ—Ç–∞—Ä–∏—É—Å—É –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤
2. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
3. –û–ø–ª–∞—Ç–∏—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—É
4. –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ

üìã –î–æ–∫—É–º–µ–Ω—Ç—ã: —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Å–º–µ—Ä—Ç–∏, –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ, –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Ä–æ–¥—Å—Ç–≤–∞."""

    def _response_general(self, text):
        """–û–±—â–∏–π –æ—Ç–≤–µ—Ç"""
        if '–∫–≤–∞—Ä—Ç–∏—Ä' in text:
            return "üè† **–í–æ–ø—Ä–æ—Å –ø–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏**\n\n–Ø –ø–æ–º–æ–≥—É —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏:\n1. –ü–æ–∫—É–ø–∫–∞/–ø—Ä–æ–¥–∞–∂–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã\n2. –ê—Ä–µ–Ω–¥–∞ –∂–∏–ª—å—è\n3. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n4. –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n–£—Ç–æ—á–Ω–∏—Ç–µ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?"
        elif '–¥–æ–≥–æ–≤–æ—Ä' in text:
            return "üìù **–í–æ–ø—Ä–æ—Å –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º**\n\n–Ø –ø–æ–º–æ–≥—É —Å:\n1. –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –¥–æ–≥–æ–≤–æ—Ä–æ–≤\n2. –†–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ–º –¥–æ–≥–æ–≤–æ—Ä–æ–≤\n3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ–º —É—Å–ª–æ–≤–∏–π\n4. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é —Å—Ç–æ—Ä–æ–Ω\n\n–£—Ç–æ—á–Ω–∏—Ç–µ —Ç–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞?"
        else:
            return """ü§ñ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫**

–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –≤–∞—à –∑–∞–ø—Ä–æ—Å. –î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —É—Ç–æ—á–Ω–∏—Ç–µ:
1. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–∞–≤–æ–≤—É—é —Å–∏—Ç—É–∞—Ü–∏—é
2. –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–π
3. –ò–º–µ—é—â–∏–µ—Å—è –¥–æ–∫—É–º–µ–Ω—Ç—ã

üìã **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
‚Ä¢ '–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –∞—Ä–µ–Ω–¥—ã –∫–≤–∞—Ä—Ç–∏—Ä—ã?'
‚Ä¢ '–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã?'
‚Ä¢ '–ö–∞–∫ –ø–æ–¥–∞—Ç—å –Ω–∞ —Ä–∞–∑–≤–æ–¥?'
‚Ä¢ '–ö–∞–∫ –≤–∑—ã—Å–∫–∞—Ç—å –∞–ª–∏–º–µ–Ω—Ç—ã?'"""

    def _get_icon(self, intent):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è –∏–Ω—Ç–µ–Ω—Ç–∞"""
        icons = {
            '–¥–æ–≥–æ–≤–æ—Ä_–∞—Ä–µ–Ω–¥—ã': 'üè†',
            '–¥–æ–≥–æ–≤–æ—Ä_–∫—É–ø–ª–∏_–ø—Ä–æ–¥–∞–∂–∏': 'üí∞',
            '—Ç—Ä—É–¥–æ–≤–æ–π_–¥–æ–≥–æ–≤–æ—Ä': 'üë®‚Äçüíº',
            '–±—Ä–∞—á–Ω—ã–π_–¥–æ–≥–æ–≤–æ—Ä': 'üíç',
            '–∞–ª–∏–º–µ–Ω—Ç—ã': 'üë∂',
            '—Ä–∞–∑–≤–æ–¥': 'üíî',
            '–Ω–∞–ª–æ–≥': 'üìä',
            '–∂–∞–ª–æ–±–∞': 'üìù',
            '–∏—Å–∫–æ–≤–æ–µ_–∑–∞—è–≤–ª–µ–Ω–∏–µ': '‚öñÔ∏è',
            '–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å': 'üìÉ',
            '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ': 'üìú',
            '—Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–µ_–¥–æ–≥–æ–≤–æ—Ä–∞': 'üìÑ',
        }
        return icons.get(intent, '‚öñÔ∏è')